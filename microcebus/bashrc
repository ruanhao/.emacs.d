#! /bin/bash

### CONSTANTS ###
NORMAL="\e[0m"
WHITE="\e[0;37m"
WHITE_BOLD="\e[1;37m"
RED="\e[0;31m"
RED_BOLD="\e[1;31m"
GREEN="\e[0;32m"
GREEN_BOLD="\e[1;32m"
YELLOW="\e[0;33m"
YELLOW_BOLD="\e[1;33m"
BLUE="\e[0;34m"
BLUE_BOLD="\e[1;34m"
MAGENTA="\e[0;35m"
MAGENTA_BOLD="\e[1;35m"
CYAN="\e[0;36m"
CYAN_BOLD="\e[1;36m"

### FUNCTIONS ###
function pick_color() {
    if [[ $? = 0 ]]; then
	echo ":)" > /tmp/bash.face
	echo -e "\e[1;36m"
    else
	echo ":(" > /tmp/bash.face
	echo -e "\e[1;35m"
    fi
}

function get_face() {
    cat /tmp/bash.face
}

function parse_git_branch {
   git branch --no-color 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/(\1)/'
}

function busy() {
    cat /dev/urandom | hexdump -C | grep "ca fe"
}

function errcode() {
    perl -le 'print $!+0, "\t", $!++ for 0..127'
}

### EXPORT ###
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8
export TERM=xterm-256color
export PS1="\[$NORMAL\]\[\$(pick_color)\]\$(get_face)\[$BLUE_BOLD\][\A]\[$GREEN_BOLD\]\u:\[$RED_BOLD\]\w\[$YELLOW_BOLD\]\$(parse_git_branch)\[$WHITE_BOLD\] > \[$NORMAL\]"
export HISTTIMEFORMAT="%F %T "
export PATH="~/.emacs.d/microcebus/bin:$PATH"
export LD_LIBRARY_PATH="$HOME/.emacs.d/microcebus/lib:$LD_LIBRARY_PATH"

### ALIAS ###
alias grep='grep --color=auto --line-buffered'
alias ll='ls -lh --color=auto'
alias ec='emacs -nw'
alias dirs='dirs -v'
alias gcc='gcc -g -rdynamic -L$HOME/.emacs.d/microcebus/lib -lpthread -lmicrocebus `pkg-config --cflags --libs glib-2.0`'
alias cde='cd ~/.emacs.d'
alias cdk='/lib/modules/$(uname -r)/kernel'
alias j='jobs -l'
# alias diff='diff -Naur'
# alias patch='patch -b'



# echo '"\C-p": history-search-backward' >> ~/.inputrc
# bind -f ~/.inputrc

if [[ -n $DISPLAY ]]; then
    # Load the user's own X resource settings
    [[ -r $HOME/.Xresources ]] && xrdb $HOME/.Xresources
fi
